name: (Happy) Successfully enables a plugin from a collection
test_id: 3.7.1
base_command: md-to-pdf
tags:
  - plugin
  - enable
  - cli
  - smoke
  - collection
  - happy-path
scenarios:
  - description: Create a collection with a plugin to enable
    test_id: 3.7.1.1
    args: >-
      collection add {{paths.fixturesDir}}/full-fat-dummies/valid-collection
      --name test-collection
    expect:
      executes: true
      contains: Successfully
  - description: Successfully enables a plugin from a collection
    test_id: 3.7.1.2
    args: >-
      plugin enable test-collection/valid-collection-plugin-1
      --bypass-validation
    expect:
      executes: true
      contains: Attempting to enable plugin
---
name: >-
  (Happy) The plugin enable command successfully enables a valid plugin (with
  validation)
test_id: 3.7.2
base_command: md-to-pdf
tags:
  - plugin
  - enable
  - cli
  - smoke
  - collection
  - validation
  - happy-path
scenarios:
  - description: Create a collection with a valid plugin
    test_id: 3.7.2.1
    args: >-
      collection add {{paths.fixturesDir}}/full-fat-dummies/valid-collection
      --name valid-coll
    expect:
      executes: true
      contains: Successfully
  - description: Successfully enables a valid plugin with validation
    test_id: 3.7.2.2
    args: plugin enable valid-coll/valid-collection-plugin-1
    expect:
      executes: true
      contains: Attempting to enable plugin
---
name: >-
  (Sad) The plugin enable command fails to enable an invalid plugin and reports
  validation errors
test_id: 3.7.3
base_command: md-to-pdf
tags:
  - plugin
  - enable
  - cli
  - smoke
  - validation
  - sad-path
scenarios:
  - description: Create broken collection and add it
    test_id: 3.7.3.1
    args: collection add {{tmpdir}}/invalid-coll --name invalid-coll
    expect:
      executes: true
      contains: Successfully
    breakage:
      plugin: invalid-plugin
      type: missing-handler
      collection: invalid-coll
  - description: Fails to enable invalid plugin and reports validation errors
    test_id: 3.7.3.2
    args: plugin enable invalid-coll/invalid-plugin
    expect:
      executes: false
      contains_all:
        - Plugin validation failed
        - Missing required file
